{% load static humanize %}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>M√£ gi·∫£m gi√° c·ªßa t√¥i</title>
    <link rel="stylesheet" href="{% static 'base/header.css' %}">
    <link rel="stylesheet" href="{% static 'base/footer.css' %}">
    <link rel="stylesheet" href="{% static 'order/promotion.css' %}">
</head>
<body>

{% include "base/header.html" %}

<main class="main-content">
    <div class="page-header">
        <h1>M√£ gi·∫£m gi√° c·ªßa t√¥i</h1>
        <p>T·∫≠n h∆∞·ªüng nh·ªØng ∆∞u ƒë√£i d√†nh ri√™ng cho b·∫°n</p>
    </div>

    <div class="voucher-grid">
        {% if vouchers %}
            {% for uv in vouchers %}
                {% with v=uv.voucher %}
                    <div class="voucher-card {% if uv.is_expiring %}expiring-soon{% endif %}">
                        
                        <div class="voucher-top">
                            {% if uv.is_expiring %}
                                <div class="voucher-badge">S·∫Øp h·∫øt h·∫°n</div>
                            {% endif %}

                            <div class="discount-main">
                                {% if v.voucher_type == "PERCENT" %}
                                    <div class="discount-value">{{ v.discount_value }}%</div>
                                    <div class="discount-type">Gi·∫£m gi√°</div>
                                {% else %}
                                    <div class="discount-value">
                                        {{ v.discount_value|floatformat:0|intcomma }}‚Ç´
                                    </div>
                                    <div class="discount-type">Gi·∫£m tr·ª±c ti·∫øp</div>
                                {% endif %}
                            </div>

                            <div class="max-discount">
                                Gi·∫£m t·ªëi ƒëa:
                                {% if v.max_discount_amount %}
                                    {{ v.max_discount_amount|floatformat:0|intcomma }}‚Ç´
                                {% else %}
                                    Kh√¥ng gi·ªõi h·∫°n
                                {% endif %}
                            </div>
                        </div>

                        <div class="voucher-middle">
                            <div class="voucher-name">{{ v.name }}</div>

                            <div class="voucher-details">
                                <div class="detail-item">
                                    <span class="detail-icon">‚úì</span>
                                    <span>ƒê∆°n t·ªëi thi·ªÉu:
                                        {{ v.min_order_amount|floatformat:0|intcomma }}‚Ç´
                                    </span>
                                </div>

                                <div class="detail-item">
                                    <span class="detail-icon">üìÖ</span>
                                    <span>HSD: {{ v.end_date|date:"d/m/Y" }}</span>
                                </div>

                                <div class="detail-item">
                                    <span class="detail-icon">üïí</span>
                                    <span>Nh·∫≠n l√∫c: {{ uv.claimed_at|date:"H:i d/m/Y" }}</span>
                                </div>
                            </div>

                            {% if uv.is_expiring %}
                                <div class="time-warning">
                                    ‚è∞ C√≤n {{ uv.days_left }} ng√†y ƒë·ªÉ s·ª≠ d·ª•ng
                                </div>
                            {% endif %}
                        </div>

                        <div class="voucher-bottom">
                            <a href="{% url 'book:book_list' %}?user_voucher={{ uv.id }}"
                               class="use-btn">
                                √Åp d·ª•ng ngay
                            </a>
                        </div>

                    </div>
                {% endwith %}
            {% endfor %}
        {% else %}
            <div class="empty-state">
                <div class="empty-icon">üéÅ</div>
                <h3>B·∫°n ch∆∞a c√≥ voucher n√†o</h3>
                <p>Tham gia ch∆∞∆°ng tr√¨nh khuy·∫øn m√£i ƒë·ªÉ nh·∫≠n ∆∞u ƒë√£i!</p>
            </div>
        {% endif %}
    </div>
</main>

{% include "base/footer.html" %}
</body>
</html>
