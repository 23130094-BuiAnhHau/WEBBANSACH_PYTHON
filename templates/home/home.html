{% load static %}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>BookStore - Tháº¿ giá»›i sÃ¡ch trá»±c tuyáº¿n</title>

    <link rel="stylesheet" href="{% static 'base/header.css' %}">
    <link rel="stylesheet" href="{% static 'base/footer.css' %}">
    <link rel="stylesheet" href="{% static 'home/home.css' %}">
</head>
<body>

{% include "base/header.html" %}

<main class="main-content">

    <!-- BANNER -->
    {% if banner %}
    <section class="banner" style="background-image: url('{{ banner.image }}');">
        <div class="container banner-content">
            <h1 class="banner-title">{{ banner.title }}</h1>
            <p class="banner-subtitle">{{ banner.subtitle }}</p>
            <a href="{% url 'book:book_list' %}" class="banner-cta">
                KhÃ¡m phÃ¡ ngay â†’
            </a>
        </div>
    </section>
    {% endif %}

    <!-- CATEGORIES -->
    <section class="categories">
        <div class="container">
            <h2 class="section-title">Danh má»¥c sÃ¡ch ná»•i báº­t</h2>

            <div class="categories-grid">
                {% for c in categories %}
                <a href="{% url 'book:book_list' %}?category={{ c.id }}" class="category-card">
                    <div class="category-icon">ðŸ“š</div>
                    <div class="category-name">{{ c.name }}</div>
                </a>
                {% endfor %}
            </div>
        </div>
    </section>
    <!-- AI RECOMMEND -->
    {% if user.is_authenticated %}
    <section class="books-section">
        <div class="container">
            <h2 class="section-title">Gá»£i Ã½ dÃ nh riÃªng cho báº¡n</h2>

            <div class="books-grid">
                {% for book in ai_recommendations|slice:":8" %}
                <div class="book-card"
                    onclick="location.href='{% url 'book:book_detail' book.id %}'">

                    <div class="book-image">
                        {% with book.images.all|first as img %}
                            {% if img %}
                                <img src="{{ img.image }}" alt="{{ book.title }}">
                            {% else %}
                                <img src="https://via.placeholder.com/250x300?text=No+Image">
                            {% endif %}
                        {% endwith %}
                    </div>

                    <div class="book-info">
                        <h3 class="book-title">
                            {{ book.title|truncatechars:50 }}
                        </h3>
                        <p class="book-author">{{ book.author }}</p>
                        <div class="book-price">
                            {{ book.get_display_price_formatted}}â‚«
                        </div>
                    </div>
                </div>
                {% empty %}
                <p class="empty-text">ChÆ°a cÃ³ gá»£i Ã½ phÃ¹ há»£p ðŸ“š</p>
                {% endfor %}
            </div>
                <div class="view-all">
                    <a href="{% url 'book:recommend_user' %}?sort=bestseller" class="view-all-btn">
                        Xem táº¥t cáº£ â†’
                    </a>
                </div>
        </div>
    </section>
    {% endif %}
    <!-- NEW BOOKS -->
    <section class="books-section">
        <div class="container">
            <h2 class="section-title">SÃ¡ch má»›i nháº¥t</h2>

            <div class="books-grid">
                {% for book in new_books|slice:":8" %}
                <div class="book-card"
                    onclick="location.href='{% url 'book:book_detail' book.id %}'">

                    <div class="book-image">
                        {% with book.images.all|first as img %}
                            {% if img %}
                                <img src="{{ img.image }}" alt="{{ book.title }}">
                            {% else %}
                                <img src="https://via.placeholder.com/250x300?text=No+Image">
                            {% endif %}
                        {% endwith %}
                    </div>

                    <div class="book-info">
                        <h3 class="book-title">
                            {{ book.title|truncatechars:50 }}
                        </h3>
                        <p class="book-author">{{ book.author }}</p>
                        <div class="book-price">
                            {{ book.get_display_price_formatted }}â‚«
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <div class="view-all">
                <a href="{% url 'book:book_list' %}?sort=new" class="view-all-btn">
                    Xem táº¥t cáº£ â†’
                </a>
            </div>
        </div>
    </section>

    <!-- BESTSELLERS -->
    <section class="books-section gray-bg">
        <div class="container">
            <h2 class="section-title">SÃ¡ch bÃ¡n cháº¡y</h2>

            <div class="books-grid">
                {% for book in bestsellers|slice:":8" %}
                <div class="book-card"
                    onclick="location.href='{% url 'book:book_detail' book.id %}'">

                    <div class="book-image">
                        {% with book.images.all|first as img %}
                            {% if img %}
                                <img src="{{ img.image }}" alt="{{ book.title }}">
                            {% else %}
                                <img src="https://via.placeholder.com/250x300?text=No+Image">
                            {% endif %}
                        {% endwith %}
                    </div>

                    <div class="book-info">
                        <h3 class="book-title">
                            {{ book.title|truncatechars:50 }}
                        </h3>
                        <p class="book-author">{{ book.author }}</p>
                        <div class="book-price">
                            {{ book.get_display_price_formatted }}â‚«
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <div class="view-all">
                <a href="{% url 'book:book_list' %}?sort=bestseller" class="view-all-btn">
                    Xem táº¥t cáº£ â†’
                </a>
            </div>
        </div>
    </section>



</main>

{% include "base/footer.html" %}

</body>
</html>
